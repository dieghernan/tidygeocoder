<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adding a Geocode Service • tidygeocoder</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Adding a Geocode Service">
<meta property="og:description" content="Refer to this page on how to add support for a geocoder service to the package.
">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidygeocoder</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tidygeocoder.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adding_geocoder_services.html">Adding a Geocode Service</a>
    </li>
    <li>
      <a href="../articles/api_reference.html">API References</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jessecambon/tidygeocoder/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="adding_geocoder_services_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Adding a Geocode Service</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jessecambon/tidygeocoder/blob/master/vignettes/adding_geocoder_services.Rmd"><code>vignettes/adding_geocoder_services.Rmd</code></a></small>
      <div class="hidden name"><code>adding_geocoder_services.Rmd</code></div>

    </div>

    
    
<p>This page documents how to add support for a new geocoder service to the package. Required changes are organized by file. If anything isn’t clear, feel free to <a href="https://github.com/jessecambon/tidygeocoder/issues">file an issue</a>.</p>
<p><strong>Base all changes on the main branch</strong>.</p>
<div id="files-to-update" class="section level2">
<h2 class="hasAnchor">
<a href="#files-to-update" class="anchor"></a>Files to Update</h2>
<ul>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/api_url.R">R/api_url.R</a></strong>
<ul>
<li>Add a standalone function for obtaining the API URL and update the <code>get_api_url()</code> function accordingly. If arguments need to be added to the <code>get_api_url()</code> function, make sure to adjust the calls to this function in the <code><a href="../reference/geo.html">geo()</a></code> and <code><a href="../reference/reverse_geo.html">reverse_geo()</a></code> functions accordingly.</li>
</ul>
</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/data-raw/api_parameter_reference.R">data-raw/api_parameter_reference.R</a></strong>
<ul>
<li>Add rows to the <a href="https://jessecambon.github.io/tidygeocoder/articles/tidygeocoder.html#api-reference">api_parameter_reference</a> dataset to include the geocoder service. Each service is referred to by a short name in the <code>method</code> column (which is how the service is specified in the <code><a href="../reference/geo.html">geo()</a></code> and <code><a href="../reference/geocode.html">geocode()</a></code> functions). The <code>generic_name</code> column has the universal parameter name that is used across geocoder services (ie. “address”, “limit”, etc.) while the <code>api_name</code> column stores the parameter names that are specific to the geocoder service.</li>
<li>Note that there is no need to include parameters that are only used for reverse geocoding or parameters that have no equivalent in other geocoding services (ie. there is no <code>generic_name</code>) <strong>unless</strong> the parameters are required. Parameters can always be passed to services directly with the <code>custom_query</code> argument in <code><a href="../reference/geo.html">geo()</a></code> or <code><a href="../reference/reverse_geo.html">reverse_geo()</a></code>.</li>
</ul>
</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/data-raw/api_references.R">data-raw/api_references.R</a></strong>
<ul>
<li>Add a row to <code>min_time_reference</code> with the minimum time each query should take (in seconds) according to the geocoder service’s free tier usage restrictions.</li>
<li>Add a row to <code>api_key_reference</code> if the service requires an API key.</li>
<li>If the service you are adding has batch geocoding capabilities, add the maximum batch size (as a row) to <code>batch_limit_reference</code>.</li>
<li>Add a row to <code>api_info_reference</code> with links to the service’s website, documentation, and usage policy.</li>
</ul>
</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/results_processing.R">R/results_processing.R</a></strong>
<ul>
<li>Update the <code><a href="../reference/extract_results.html">extract_results()</a></code> function which is used for parsing single addresses (ie. not batch geocoding). You can see examples of how I’ve tested out parsing the results of geocoder services <a href="https://github.com/jessecambon/tidygeocoder/tree/master/sandbox/query_debugging">here</a>.</li>
<li>In a similar fashion, update the <code><a href="../reference/extract_reverse_results.html">extract_reverse_results()</a></code> function for reverse geocoding.</li>
<li>Update the <code>extract_errors_from_results()</code> function to extract error messages for invalid queries.</li>
</ul>
</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/geo.R">R/geo.R</a></strong>
<ul>
<li>If you added a batch geocoding function, you’ll need to add it to the named list <code>batch_func_map</code> so that the <code><a href="../reference/geo.html">geo()</a></code> function knows it is associated with your method.</li>
<li>Add the new method to the <code><a href="../reference/geo.html">geo()</a></code> documentation.</li>
</ul>
</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/batch_geocoding.R">R/batch_geocoding.R</a></strong>
<ul>
<li>If the service supports batch geocoding then add a function for this capability. These functions are called from <code><a href="../reference/geo.html">geo()</a></code>.</li>
</ul>
</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/reverse_geo.R">R/reverse_geo.R</a></strong>
<ul>
<li>Update the <code>get_coord_parameters()</code> function based on how the service passed latitude and longitude coordinates for reverse geocoding.</li>
<li>If the service supports reverse batch geocoding then add a new function in <a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/reverse_batch_geocoding.R">R/reverse_batch_geocoding.R</a> and add it to the <code>reverse_batch_func_map</code> named list.</li>
</ul>
</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/geo_methods.R">R/geo_methods.R</a></strong>
<ul>
<li>Add a new <code>geo_&lt;method&gt;()</code> convenience function to <a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/geo_methods.R">R/geo_methods.R</a>.</li>
</ul>
</li>
<li>If applicable, add new tests to the scripts in the <a href="https://github.com/jessecambon/tidygeocoder/tree/master/tests/testthat">tests directory</a> for the method. Note that tests should avoid making a HTTP query (ie. use <code>no_query = TRUE</code> in the <code><a href="../reference/geo.html">geo()</a></code> and <code><a href="../reference/geocode.html">geocode()</a></code> functions.</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/global_variables.R">R/global_variables.R</a></strong>
<ul>
<li>If applicable, add your service to one of the global variables.</li>
</ul>
</li>
</ul>
</div>
<div id="other-files" class="section level2">
<h2 class="hasAnchor">
<a href="#other-files" class="anchor"></a>Other Files</h2>
<p>These files don’t necessarily need to be updated. However, you might need to make changes to these files if the service you are implementing requires some non-standard workarounds.</p>
<ul>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/query_factory.R">R/query_factory.R</a></strong>
<ul>
<li>Houses the functions used to create and execute API queries.</li>
</ul>
</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/documentation.R">R/documentation.R</a></strong>
<ul>
<li>Functions for producing rmarkdown package documentation.</li>
</ul>
</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/data.R">R/data.R</a></strong>
<ul>
<li>Documentation for in-built datasets.</li>
</ul>
</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/utils.R">R/utils.R</a></strong>
<ul>
<li>Common utility functions.</li>
</ul>
</li>
<li>
<strong><a href="https://github.com/jessecambon/tidygeocoder/blob/master/R/input_handling.R">R/input_handling.R</a></strong>
<ul>
<li>Handles the deduplication of input data.</li>
</ul>
</li>
</ul>
</div>
<div id="testing" class="section level2">
<h2 class="hasAnchor">
<a href="#testing" class="anchor"></a>Testing</h2>
<ul>
<li>Test out the new method with <code>verbose = TRUE</code> to make sure it behaves as expected. You can reference tests available <a href="https://github.com/jessecambon/tidygeocoder/tree/master/sandbox">the ‘sandbox’ folder</a> for reference.</li>
<li>Run <code><a href="https://devtools.r-lib.org//reference/check.html">devtools::check()</a></code> to make sure the package still passes all tests and the vignette runs properly. To only run the package tests use <code><a href="https://devtools.r-lib.org//reference/test.html">devtools::test()</a></code>, but note these tests do not query the geocoder services to avoid external dependencies.</li>
<li>Run <a href="https://github.com/jessecambon/tidygeocoder/blob/master/external_tests/online_tests.R">external_tests/online_tests.R</a> which will test making queries to the geocoder services. These tests are not included internally because they require API keys which would not exist on all systems and are dependent on the geocoder services being online at that the time of the test.</li>
<li>Run the commands detailed in <a href="https://github.com/jessecambon/tidygeocoder/blob/master/cran-comments.md">cran-comments.md</a> to test the package on other environments.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://jessecambon.github.io">Jesse Cambon</a>, <a href="https://github.com/dieghernan">Diego Hernangómez</a>, Christopher Belanger, Daniel Possenriede.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '2a4961d1f7b45ceee241419b8e8257d3',
    indexName: 'tidygeocoder',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
